<div class="relative flex flex-col gap-2 p-5">
  <button
    mat-icon-button
    class="!absolute top-2 right-2 !flex"
    (click)="closeDialog()">
    <i class="m-auto text-lg mdi mdi-close"></i>
  </button>

  <h3 class="text-2xl font-bold text-center">
    <i class="mdi mdi-tune-vertical"></i> Filters
  </h3>

  <form [formGroup]="filterFormGroup">
    <div class="flex gap-4 p-8 border border-slate-300 rounded-xl">
      <ul
        class="flex flex-col gap-4 *:grid *:grid-cols-4 *:gap-4 *:first:col-span-1">
        <li formGroupName="volume">
          <span>Trade Volume</span>

          <mat-form-field subscriptSizing="dynamic">
            <mat-label>Filter Type</mat-label>
            <mat-select #tradeFilter formControlName="type">
              @for (item of filterConstants.FILTER_TYPES; track $index) {
                <mat-option [value]="item.value">{{ item.label }}</mat-option>
              }
            </mat-select>
          </mat-form-field>

          <mat-form-field subscriptSizing="dynamic">
            <mat-label>{{
              tradeFilter.value === 'between' ||
              tradeFilter.value === 'notBetween'
                ? 'Min'
                : 'Value'
            }}</mat-label>
            <input matInput formControlName="min" />
          </mat-form-field>

          @if (
            tradeFilter.value === 'between' ||
            tradeFilter.value === 'notBetween'
          ) {
            <mat-form-field subscriptSizing="dynamic">
              <mat-label>Max</mat-label>
              <input matInput formControlName="max" />
            </mat-form-field>
          }
        </li>

        <li formGroupName="changePercent">
          <span>Price Change Percentage</span>

          <mat-form-field subscriptSizing="dynamic">
            <mat-label>Filter Type</mat-label>
            <mat-select #priceChangePercentageFilter formControlName="type">
              @for (item of filterConstants.FILTER_TYPES; track $index) {
                <mat-option [value]="item.value">{{ item.label }}</mat-option>
              }
            </mat-select>
          </mat-form-field>

          <mat-form-field subscriptSizing="dynamic">
            <mat-label>{{
              priceChangePercentageFilter.value === 'between' ||
              priceChangePercentageFilter.value === 'notBetween'
                ? 'Min'
                : 'Value'
            }}</mat-label>
            <input matInput formControlName="min" />
          </mat-form-field>

          @if (
            priceChangePercentageFilter.value === 'between' ||
            priceChangePercentageFilter.value === 'notBetween'
          ) {
            <mat-form-field subscriptSizing="dynamic">
              <mat-label>Max</mat-label>
              <input matInput formControlName="max" />
            </mat-form-field>
          }
        </li>

        <li formGroupName="price">
          <span>Price</span>

          <mat-form-field subscriptSizing="dynamic">
            <mat-label>Filter Type</mat-label>
            <mat-select #priceFilter formControlName="type">
              @for (item of filterConstants.FILTER_TYPES; track $index) {
                <mat-option [value]="item.value">{{ item.label }}</mat-option>
              }
            </mat-select>
          </mat-form-field>

          <mat-form-field subscriptSizing="dynamic">
            <mat-label>{{
              priceFilter.value === 'between' ? 'Min' : 'Value'
            }}</mat-label>
            <input matInput formControlName="min" />
          </mat-form-field>

          @if (
            priceFilter.value === 'between' ||
            priceFilter.value === 'notBetween'
          ) {
            <mat-form-field subscriptSizing="dynamic">
              <mat-label>Max</mat-label>
              <input matInput formControlName="max" />
            </mat-form-field>
          }
        </li>
      </ul>
    </div>

    <div class="flex items-center justify-center gap-4 mt-4">
      <button mat-flat-button (click)="applyFilter()">Apply</button>
      <button
        mat-raised-button
        (click)="resetFilter()"
        [disabled]="!filterFormGroup.dirty">
        Reset
      </button>
    </div>
  </form>
</div>
